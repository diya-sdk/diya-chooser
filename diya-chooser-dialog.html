<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-fab/paper-fab.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">

<link rel="import" href="diya-chooser.html">


<polymer-element name="diya-chooser-dialog" attributes="selector forceAuth noAuth single">
	<template>
		<paper-button on-tap="{{actionToggle}}">Select diya...</paper-button>
			<style>

			paper-dialog{
					box-shadow: 0px 0px 15px #555;
					padding: 20px;
					background: white;
					display: flex;
					flex-direction: column;
					justify-content: center;
					align-items: center;
					/*min-height: 150px;*/
					margin: 0px;
				}
				paper-dialog::shadow #scroller{
					min-height: 150px;
					}

				diya-chooser{
					width: 100%;
					flex: 1;
					padding: 0px;
				}

				paper-dialog > paper-button {
					position: absolute;
					top: 0px;
					right: 0px;
				}

				@media screen and (max-device-width: 480px), screen and (orientation: portrait){
					paper-dialog{
						width: 100vw;
						height: 100vh;
						padding: 0px;
						box-shadow: auto;

					}

				}
			</style>
		<paper-dialog id="dialog" layered="false">
			<paper-button on-tap="{{toggle}}">
				<paper-fab icon="close" mini title="close dialog" role="button" style="background: grey">
				</paper-fab>
			</paper-button>
			<diya-chooser selector="{{selector}}" single="{{single}}" forceAuth="{{forceAuth}}" noAuth="{{noAuth}}"></diya-chooser>
		</paper-dialog>
	</template>



	<script>



		Polymer({

			forceAuth: false,
			noAuth: false,
			single: false,

			ready: function(){
			},

			domReady: function() {
				var that = this;
				var orgInnerHeight = window.innerHeight;
				test = this
				// should addEventListener?
				window.onresize = function() { console.log(Math.abs(orgInnerHeight - window.innerHeight) / window.innerHeight)
					if (window.innerHeight === orgInnerHeight) {
						// restore dialog top
						setTimeout(function() {
							that.$.dialog.style.top = null;
							that.$.dialog.style.height = null;
							}, 100);
					} else if ( Math.abs(orgInnerHeight - window.innerHeight) / window.innerHeight < 0.2 ) {
						// overlay keyboard
						setTimeout(function() {
							that.$.dialog.style.top = "0px";
							that.$.dialog.style.height = "100px";
							}, 100);
					} else {
						// do nothing
					}
				};
			},

			toggle: function(){
				this.$.dialog.toggle();
			},

			show: function(){
				this.$.dialog.opened = true;
			},

			hide: function(){
				this.$.dialog.opened = false;
			},

			///////////////////////////////////////
			////////// Action handlers ////////////
			///////////////////////////////////////

			selectorChanged: function(){
				this.hide();
			},

			actionToggle: function(){
				this.toggle();
			}
		});
	</script>
</polymer-element>
